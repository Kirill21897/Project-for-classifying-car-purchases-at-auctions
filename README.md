# Project-for-classifying-car-purchases-at-auctions
## Обзор

Этот проект, реализованный в Jupyter Notebook, представляет собой исследование методов машинного обучения для бинарной классификации покупок подержанных автомобилей на аукционах. Цель — предсказать, является ли покупка "плохой" (IsBadBuy = 1, т.е. "lemon" car), чтобы минимизировать финансовые убытки. Проект включает обработку данных, создание новых признаков, обучение моделей классификации, отбор признаков, настройку гиперпараметров и оценку по различным метрикам (Gini, Recall, Precision, F1, AUC PR).

Проект состоит из следующих частей:
1. **Подготовка данных**: Загрузка, предобработка, кодирование категориальных переменных и разделение на выборки.
2. **Feature engineering**: Создание новых признаков (фракции, групповые аггрегации) и отбор с помощью логистической регрессии и L1-регуляризации.
3. **Моделирование**: Обучение и сравнение моделей (Logistic Regression, Gaussian NB, KNN, SVC с RBF-ядром).
4. **Оценка**: Расчет метрик, включая Gini, и анализ наилучшей метрики для бизнеса (Recall для минимизации False Negatives).

## Цели проекта

- Обработать датасет о покупках автомобилей на аукционах, включая заполнение пропусков и кодирование категориальных переменных.
- Создать улучшенные признаки для повышения качества моделей (например, соотношения цен, групповые статистики по брендам/моделям).
- Обучить и сравнить модели классификации, включая нелинейные (SVC с RBF-ядром как бонус).
- Отобрать признаки с помощью коэффициентов модели и L1-регуляризации.
- Настроить гиперпараметры с помощью GridSearchCV и оценить модели по Gini на train/valid/test.
- Реализовать и сравнить метрики Recall, Precision, F1 и AUC PR.
- Определить лучшую метрику для выявления "lemon" cars (Recall, чтобы минимизировать пропуски плохих машин).

## Датасет

Датасет содержит информацию о покупках подержанных автомобилей на аукционах (Kaggle "Don't Get Kicked!"). Основные признаки включают:
- `IsBadBuy`: Целевая переменная (0/1, плохая покупка).
- `PurchDate`, `VehYear`, `VehicleAge`: Дата покупки, год выпуска, возраст автомобиля.
- `Make`, `Model`, `Trim`, `SubModel`: Бренд, модель, комплектация.
- `Auction`, `Color`, `Transmission`: Аукцион, цвет, тип трансмиссии.
- Цены: `MMRAcquisitionAuctionAveragePrice`, `VehBCost` и др.
- Дополнительные: `BYRNO` (покупатель), `VNZIP1` (почтовый индекс), `WarrantyCost`.

Данные проходят предобработку: заполнение пропусков (медиана), кодирование (LabelEncoder, CountEncoder), масштабирование (StandardScaler) и создание новых признаков (например, соотношения цен, средние по группам).

## Требования

Для работы с проектом необходимы следующие зависимости:
- Python 3.8 или выше
- Jupyter Notebook
- Библиотеки Python:
  ```bash
  pip install pandas numpy scikit-learn category_encoders
